(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[634],{556:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth",function(){return r(5243)}])},5170:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var o=r(7914);let s=async e=>{for(let t of["/api/auth","https://workspace-eight-mocha.vercel.app/api/auth"])try{let r=await fetch("".concat(t).concat(e.replace("/api/auth","")),{credentials:"include",headers:{"Content-Type":"application/json"}});if(r.ok)return r.json();if(401===r.status)return null}catch(e){console.log("Failed to connect to ".concat(t,", trying next..."));continue}throw Error("All authentication endpoints failed")};function a(){let{data:e,isLoading:t,error:r}=(0,o.I)({queryKey:["/api/auth/user"],queryFn:()=>s("/api/auth/user"),retry:!1,staleTime:3e5,refetchOnWindowFocus:!1,refetchOnMount:!0});return{user:e,isLoading:t,isAuthenticated:!!e,error:r,login:()=>{window.location.href="/auth"},logout:async()=>{for(let e of["/api/auth","https://workspace-eight-mocha.vercel.app/api/auth"])try{await fetch("".concat(e,"/logout"),{method:"POST",credentials:"include"});break}catch(e){continue}window.location.href="/"}}}},5243:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var o=r(7876),s=r(4232),a=r(9099),l=r(5170);function i(){let e=(0,a.useRouter)(),{user:t,isLoading:r}=(0,l.A)(),[i,n]=(0,s.useState)("login"),[d,c]=(0,s.useState)(!1),[u,h]=(0,s.useState)(""),[m,p]=(0,s.useState)(""),[b,f]=(0,s.useState)(!1),[x,g]=(0,s.useState)(""),[w,v]=(0,s.useState)(""),[j,N]=(0,s.useState)({emailOrPhone:"",password:""}),[y,C]=(0,s.useState)({email:"",phone:"",firstName:"",lastName:"",password:"",confirmPassword:""}),[k,S]=(0,s.useState)({code:""});(0,s.useEffect)(()=>{!r&&t&&e.push("/")},[t,r,e]);let E=async t=>{t.preventDefault(),f(!0),g("");try{let t=await fetch("".concat("","/api/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(j)}),r=await t.json();t.ok?(v("Login bem-sucedido!"),setTimeout(()=>e.push("/"),1e3)):g(r.error||"Erro no login")}catch(e){g("Erro de conex\xe3o")}finally{f(!1)}},P=async e=>{if(e.preventDefault(),f(!0),g(""),y.password!==y.confirmPassword){g("As passwords n\xe3o coincidem"),f(!1);return}try{let e=await fetch("".concat("","/api/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:y.email||void 0,phone:y.phone||void 0,firstName:y.firstName,lastName:y.lastName,password:y.password})}),t=await e.json();e.ok?(h(t.userId),p(t.verificationType),c(!0),v("C\xf3digo de verifica\xe7\xe3o enviado!")):g(t.error||"Erro no registo")}catch(e){g("Erro de conex\xe3o")}finally{f(!1)}},T=async t=>{t.preventDefault(),f(!0),g("");try{let t=await fetch("".concat("","/api/auth/verify"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({userId:u,code:k.code,type:m})}),r=await t.json();t.ok?(v("Verifica\xe7\xe3o bem-sucedida!"),setTimeout(()=>e.push("/"),1e3)):g(r.error||"C\xf3digo inv\xe1lido")}catch(e){g("Erro de conex\xe3o")}finally{f(!1)}},O=async()=>{f(!0),g("");try{let e=await fetch("".concat("","/api/auth/resend-code"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({userId:u,type:m})}),t=await e.json();e.ok?v("C\xf3digo reenviado!"):g(t.error||"Erro ao reenviar c\xf3digo")}catch(e){g("Erro de conex\xe3o")}finally{f(!1)}};return r?(0,o.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("div",{className:"w-8 h-8 border-3 border-blue-400 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,o.jsx)("p",{className:"text-white",children:"Carregando..."})]})}):d?(0,o.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4",children:(0,o.jsx)("div",{className:"w-full max-w-md",children:(0,o.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl shadow-2xl p-8 border border-white/20",children:[(0,o.jsxs)("div",{className:"text-center mb-8",children:[(0,o.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Verifica\xe7\xe3o"}),(0,o.jsxs)("p",{className:"text-blue-200",children:["C\xf3digo enviado para o vosso ","email"===m?"email":"telem\xf3vel"]})]}),x&&(0,o.jsx)("div",{className:"bg-red-500/20 border border-red-500/30 rounded-lg p-3 mb-4",children:(0,o.jsx)("p",{className:"text-red-200 text-sm",children:x})}),w&&(0,o.jsx)("div",{className:"bg-green-500/20 border border-green-500/30 rounded-lg p-3 mb-4",children:(0,o.jsx)("p",{className:"text-green-200 text-sm",children:w})}),(0,o.jsxs)("form",{onSubmit:T,className:"space-y-6",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-blue-200 mb-2",children:"C\xf3digo de Verifica\xe7\xe3o"}),(0,o.jsx)("input",{type:"text",value:k.code,onChange:e=>S({...k,code:e.target.value}),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent text-center text-2xl tracking-widest",placeholder:"000000",maxLength:"6",required:!0})]}),(0,o.jsx)("button",{type:"submit",disabled:b,className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-3 px-4 rounded-lg font-medium hover:from-blue-600 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2 focus:ring-offset-transparent transition-all duration-200 disabled:opacity-50",children:b?"Verificando...":"Verificar"}),(0,o.jsx)("div",{className:"text-center",children:(0,o.jsx)("button",{type:"button",onClick:O,disabled:b,className:"text-blue-300 hover:text-blue-200 text-sm underline",children:"Reenviar c\xf3digo"})})]})]})})}):(0,o.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-indigo-900 flex items-center justify-center p-4",children:(0,o.jsx)("div",{className:"w-full max-w-md",children:(0,o.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-2xl shadow-2xl overflow-hidden border border-white/20",children:[(0,o.jsxs)("div",{className:"text-center py-8 px-6",children:[(0,o.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Judas Legal Assistant"}),(0,o.jsx)("p",{className:"text-blue-200",children:"Assistente jur\xeddico para Mo\xe7ambique"})]}),(0,o.jsxs)("div",{className:"flex border-b border-white/20",children:[(0,o.jsx)("button",{onClick:()=>n("login"),className:"flex-1 py-4 px-6 text-center font-medium transition-colors ".concat("login"===i?"text-white bg-white/10 border-b-2 border-blue-400":"text-blue-200 hover:text-white hover:bg-white/5"),children:"Entrar"}),(0,o.jsx)("button",{onClick:()=>n("register"),className:"flex-1 py-4 px-6 text-center font-medium transition-colors ".concat("register"===i?"text-white bg-white/10 border-b-2 border-blue-400":"text-blue-200 hover:text-white hover:bg-white/5"),children:"Registar"})]}),(0,o.jsxs)("div",{className:"p-6",children:[x&&(0,o.jsx)("div",{className:"bg-red-500/20 border border-red-500/30 rounded-lg p-3 mb-4",children:(0,o.jsx)("p",{className:"text-red-200 text-sm",children:x})}),w&&(0,o.jsx)("div",{className:"bg-green-500/20 border border-green-500/30 rounded-lg p-3 mb-4",children:(0,o.jsx)("p",{className:"text-green-200 text-sm",children:w})}),"login"===i?(0,o.jsxs)("form",{onSubmit:E,className:"space-y-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-blue-200 mb-2",children:"Email ou Telem\xf3vel"}),(0,o.jsx)("input",{type:"text",value:j.emailOrPhone,onChange:e=>N({...j,emailOrPhone:e.target.value}),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent",placeholder:"utilizador@exemplo.com ou +258...",required:!0})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-blue-200 mb-2",children:"Password"}),(0,o.jsx)("input",{type:"password",value:j.password,onChange:e=>N({...j,password:e.target.value}),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent",placeholder:"Password",required:!0})]}),(0,o.jsx)("button",{type:"submit",disabled:b,className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-3 px-4 rounded-lg font-medium hover:from-blue-600 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2 focus:ring-offset-transparent transition-all duration-200 disabled:opacity-50",children:b?"Entrando...":"Entrar"})]}):(0,o.jsxs)("form",{onSubmit:P,className:"space-y-4",children:[(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-blue-200 mb-2",children:"Nome"}),(0,o.jsx)("input",{type:"text",value:y.firstName,onChange:e=>C({...y,firstName:e.target.value}),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent",placeholder:"Nome",required:!0})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-blue-200 mb-2",children:"Apelido"}),(0,o.jsx)("input",{type:"text",value:y.lastName,onChange:e=>C({...y,lastName:e.target.value}),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent",placeholder:"Apelido",required:!0})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-blue-200 mb-2",children:"Email"}),(0,o.jsx)("input",{type:"email",value:y.email,onChange:e=>C({...y,email:e.target.value}),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent",placeholder:"utilizador@exemplo.com"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-blue-200 mb-2",children:"Telem\xf3vel (opcional)"}),(0,o.jsx)("input",{type:"tel",value:y.phone,onChange:e=>C({...y,phone:e.target.value}),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent",placeholder:"+258 XX XXX XXXX"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-blue-200 mb-2",children:"Password"}),(0,o.jsx)("input",{type:"password",value:y.password,onChange:e=>C({...y,password:e.target.value}),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent",placeholder:"M\xednimo 6 caracteres",required:!0})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-blue-200 mb-2",children:"Confirmar Password"}),(0,o.jsx)("input",{type:"password",value:y.confirmPassword,onChange:e=>C({...y,confirmPassword:e.target.value}),className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-white/50 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent",placeholder:"Repetir password",required:!0})]}),(0,o.jsx)("button",{type:"submit",disabled:b,className:"w-full bg-gradient-to-r from-emerald-500 to-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:from-emerald-600 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:ring-offset-2 focus:ring-offset-transparent transition-all duration-200 disabled:opacity-50",children:b?"Criando conta...":"Criar Conta"})]}),(0,o.jsxs)("div",{className:"mt-6",children:[(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,o.jsx)("div",{className:"w-full border-t border-white/20"})}),(0,o.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,o.jsx)("span",{className:"px-2 bg-transparent text-blue-200",children:"ou"})})]}),(0,o.jsxs)("button",{onClick:()=>{window.location.href="".concat("","/api/auth/google")},className:"mt-4 w-full bg-white text-gray-700 py-3 px-4 rounded-lg font-medium hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2 focus:ring-offset-transparent transition-all duration-200 flex items-center justify-center space-x-2",children:[(0,o.jsxs)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[(0,o.jsx)("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,o.jsx)("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,o.jsx)("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,o.jsx)("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),(0,o.jsx)("span",{children:"Continuar com Google"})]})]})]})]})})})}},9099:(e,t,r)=>{e.exports=r(8253)}},e=>{e.O(0,[914,636,593,792],()=>e(e.s=556)),_N_E=e.O()}]);